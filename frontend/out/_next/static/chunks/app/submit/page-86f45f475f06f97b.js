(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[731],{1025:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>i});var r=o(8865),s=o(6853),a=o(6411),n=o(4794);function i(){let[e,t]=(0,s.useState)(""),[o,i]=(0,s.useState)(""),[l,c]=(0,s.useState)(""),[u,d]=(0,s.useState)(!1),[m,h]=(0,s.useState)(null),b=(0,a.useRouter)(),p=async t=>{if(t.preventDefault(),!e.trim()||!o.trim()&&!l.trim())return void h("Title and either URL or text are required");try{d(!0);let t=localStorage.getItem("token");await (0,n.tt)(e,o||void 0,l||void 0,t||void 0),b.push("/")}catch(e){h("Failed to submit post"),console.error(e)}finally{d(!1)}};return(0,r.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Submit New Post"}),(0,r.jsxs)("form",{onSubmit:p,className:"max-w-2xl",children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),(0,r.jsx)("input",{id:"title",type:"text",value:e,onChange:e=>t(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Post title",disabled:u})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"url",className:"block text-sm font-medium text-gray-700 mb-1",children:"URL (optional)"}),(0,r.jsx)("input",{id:"url",type:"url",value:o,onChange:e=>i(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"https://example.com",disabled:u})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"text",className:"block text-sm font-medium text-gray-700 mb-1",children:"Text (optional)"}),(0,r.jsx)("textarea",{id:"text",value:l,onChange:e=>c(e.target.value),className:"w-full p-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Post content",rows:4,disabled:u})]}),m&&(0,r.jsx)("div",{className:"text-red-500 text-sm mb-4",children:m}),(0,r.jsxs)("div",{className:"flex space-x-3",children:[(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-orange-500 text-white rounded-md hover:bg-orange-600 disabled:opacity-50",disabled:u,children:u?"Submitting...":"Submit"}),(0,r.jsx)("button",{type:"button",onClick:()=>b.push("/"),className:"px-4 py-2 bg-gray-500 text-white rounded-md hover:bg-gray-600",children:"Cancel"})]})]})]})}},4794:(e,t,o)=>{"use strict";o.d(t,{iD:()=>a,kz:()=>n,tt:()=>i,xG:()=>s});let r="https://hn-clone-api.hacker-news-roo.workers.dev";async function s(){let e=await fetch("".concat(r,"/posts/hot"),{next:{revalidate:60}});if(!e.ok)throw Error("Failed to fetch posts");return e.json()}async function a(e,t){let o=await fetch("".concat(r,"/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});if(!o.ok)throw Error("Login failed");return o.json()}async function n(e,t,o){let s=await fetch("".concat(r,"/auth/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,username:t,password:o})});if(!s.ok)throw Error("Registration failed");return s.json()}async function i(e,t,o,s){let a=await fetch("".concat(r,"/posts/submit"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s)},body:JSON.stringify({title:e,url:t,text:o})});if(!a.ok)throw Error("Failed to submit post");return a.json()}},6411:(e,t,o)=>{"use strict";var r=o(4371);o.o(r,"useRouter")&&o.d(t,{useRouter:function(){return r.useRouter}})},9316:(e,t,o)=>{Promise.resolve().then(o.bind(o,1025))}},e=>{e.O(0,[38,972,358],()=>e(e.s=9316)),_N_E=e.O()}]);